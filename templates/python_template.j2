from airflow import DAG
from airflow.operators.python import PythonOperator
import pendulum

{{ python_code }}

with DAG(
    dag_id="{{ dag_id }}",
    start_date=pendulum.parse("{{ start_date }}"),
    schedule_interval="{{ schedule }}",
    catchup=False,
    tags=["py-auto"]
) as dag:

{% for fn in functions %}
    {{ fn }}_task = PythonOperator(
        task_id="{{ fn }}",
        python_callable={{ fn }},
    )

{% endfor %}

{% for i in range(functions|length -1) %}
    {{ functions[i] }}_task >> {{ functions[i+1] }}_task
{% endfor %}